<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>【最終改訂版】メルカリ・Amazon販売 確定申告フローチャート</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }
       
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
       
        .header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 20px;
        }
       
        .header h1 {
            color: #2c3e50;
            margin: 0;
            font-size: 2.2em;
            font-weight: 700;
        }
       
        .header .subtitle {
            color: #7f8c8d;
            margin-top: 10px;
            font-size: 1.1em;
        }
       
        .flowchart {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
       
        .question-box {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            max-width: 600px;
            font-weight: 600;
            font-size: 1.1em;
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
            position: relative;
        }
       
        .answer-section {
            display: flex;
            gap: 30px;
            margin: 20px 0;
            justify-content: center;
            flex-wrap: wrap;
        }
       
        .answer-button {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 20px 40px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
            min-width: 120px;
        }
       
        .answer-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4);
        }
       
        .answer-button.yes {
            background: linear-gradient(135deg, #27ae60, #229954);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
        }
       
        .answer-button.yes:hover {
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.4);
        }
       
        .result-box {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            max-width: 600px;
            font-weight: 600;
            font-size: 1.2em;
            box-shadow: 0 10px 30px rgba(243, 156, 18, 0.3);
            margin: 20px 0;
        }
       
        .result-box.required {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            box-shadow: 0 10px 30px rgba(231, 76, 60, 0.3);
        }
       
        .result-box.not-required {
            background: linear-gradient(135deg, #27ae60, #229954);
            box-shadow: 0 10px 30px rgba(39, 174, 96, 0.3);
        }
       
        .result-box.partial {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            box-shadow: 0 10px 30px rgba(243, 156, 18, 0.3);
        }
       
        .arrow {
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 20px solid #bdc3c7;
            margin: 10px 0;
        }
       
        .explanation {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 0.9em;
            line-height: 1.6;
            color: #2c3e50;
        }
       
        .hidden {
            display: none;
        }
       
        .calculation-help {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            font-size: 0.95em;
        }
       
        .calculation-help h4 {
            color: #856404;
            margin-top: 0;
        }
       
        .reset-button {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            margin-top: 20px;
            transition: all 0.3s ease;
        }
       
        .reset-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(149, 165, 166, 0.4);
        }

        .highlight {
            background: #ff1744;
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-weight: bold;
            border: 2px solid #d50000;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            animation: blink 2s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.7; }
        }

        .warning-box {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 0.9em;
        }

        .info-box {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 0.9em;
        }

        .examples-list {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 0.9em;
        }

        .examples-list ul {
            margin: 5px 0;
            padding-left: 20px;
        }

        .action-plan {
            background: #e8f5e8;
            border: 1px solid #c3e6c3;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            font-size: 0.95em;
        }

        .action-plan h4 {
            color: #2d5a2d;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .action-step {
            background: white;
            padding: 12px;
            margin: 8px 0;
            border-radius: 6px;
            border-left: 4px solid #4CAF50;
        }

        .action-step strong {
            color: #2d5a2d;
        }

        .deadline-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: bold;
            color: #856404;
        }

        .income-classification {
            background: #f8f9fa;
            border: 2px solid #6c757d;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .classification-title {
            color: #495057;
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 15px;
            text-align: center;
        }

        .vs-comparison {
            display: flex;
            gap: 15px;
            margin: 15px 0;
        }

        .business-income, .misc-income {
            flex: 1;
            padding: 15px;
            border-radius: 8px;
            font-size: 0.9em;
        }

        .business-income {
            background: #d4edda;
            border: 1px solid #c3e6cb;
        }

        .misc-income {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
        }

        .classification-criteria {
            background: #e2e3e5;
            padding: 12px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📋 確定申告診断</h1>
            <div class="subtitle">あなたに確定申告が必要かどうかを診断します</div>
        </div>

        <div class="flowchart">
            <div id="step1" class="question-box">
                <strong>【STEP 1】何を販売していますか？</strong>
                <div class="explanation">
                    まず、販売している商品の種類を教えてください
                </div>
            </div>
            <div class="answer-section">
                <button class="answer-button" onclick="nextStep(1, 'lifestyle')">🏠 生活用品の処分<br>（古着・家具・家電・本など）</button>
                <button class="answer-button" onclick="nextStep(1, 'business')">💰 営利目的の販売<br>（転売・ハンドメイド・仕入商品）</button>
                <button class="answer-button" onclick="nextStep(1, 'collectible')">💎 収集品・高級品<br>（トレカ・限定品・貴金属など）</button>
            </div>

            <div id="step2a" class="hidden">
                <div class="arrow"></div>
                <div class="question-box">
                    <strong>【STEP 2A】高額な商品はありますか？</strong>
                    <div class="explanation">
                        1個または1組で30万円を超える商品を売りましたか？
                    </div>
                </div>
                <div class="examples-list">
                    <strong>30万円超の例：</strong>
                    <ul>
                        <li>高級腕時計、貴金属、宝石類</li>
                        <li>高級バッグ（エルメス・シャネルなど）</li>
                        <li>骨董品、美術品</li>
                        <li>ペアアイテム（イヤリング等）の場合は1組の合計額</li>
                    </ul>
                </div>
                <div class="answer-section">
                    <button class="answer-button yes" onclick="showResult('lifestyle-expensive')">はい（30万円超あり）</button>
                    <button class="answer-button" onclick="nextStep(2, 'lifestyle-cheap')">いいえ（すべて30万円以下）</button>
                </div>
            </div>

            <div id="step2b" class="hidden">
                <div class="arrow"></div>
                <div class="question-box">
                    <strong>【STEP 2B】販売の規模・頻度はどれくらいですか？</strong>
                    <div class="explanation">
                        継続性・反復性が課税判定の重要な要素です
                    </div>
                </div>
                <div class="examples-list">
                    <strong>営利目的・継続的の例：</strong>
                    <ul>
                        <li>毎月複数商品を継続的に販売</li>
                        <li>転売目的での商品仕入れ</li>
                        <li>ハンドメイド品の定期的な製作・販売</li>
                        <li>明確な利益を目的とした活動</li>
                    </ul>
                </div>
                <div class="answer-section">
                    <button class="answer-button yes" onclick="nextStep(2, 'business-regular')">継続的・大規模</button>
                    <button class="answer-button" onclick="nextStep(2, 'business-occasional')">時々・小規模</button>
                </div>
            </div>

            <div id="step2c" class="hidden">
                <div class="arrow"></div>
                <div class="question-box">
                    <strong>【STEP 2C】「生活に通常必要でない動産」に該当しますか？</strong>
                    <div class="explanation">
                        収集品や投資目的で保有していた物品は特別な扱いになります
                    </div>
                </div>
                <div class="examples-list">
                    <strong>「生活に通常必要でない動産」の例：</strong>
                    <ul>
                        <li>トレーディングカード（ポケカ・遊戯王など）</li>
                        <li>限定スニーカー・高級時計（投資目的保有）</li>
                        <li>レコード・CD（コレクション目的）</li>
                        <li>フィギュア・プラモデル（観賞・収集目的）</li>
                    </ul>
                </div>
                <div class="answer-section">
                    <button class="answer-button yes" onclick="nextStep(2, 'collectible-luxury')">該当する</button>
                    <button class="answer-button" onclick="nextStep(2, 'collectible-normal')">該当しない</button>
                </div>
            </div>

            <div id="step3a" class="hidden">
                <div class="arrow"></div>
                <div class="question-box">
                    <strong>【STEP 3A】販売は純粋な不用品処分ですか？</strong>
                    <div class="explanation">
                        たとえ生活用品でも、営利目的なら課税対象になります
                    </div>
                </div>
                <div class="warning-box">
                    ⚠️ <strong>注意：</strong>古着でも、転売目的で購入→即販売や、継続的な利益目的販売は営利活動と判定される可能性があります
                </div>
                <div class="answer-section">
                    <button class="answer-button yes" onclick="showResult('lifestyle-safe')">純粋な不用品処分</button>
                    <button class="answer-button" onclick="nextStep(3, 'lifestyle-business')">利益目的の要素あり</button>
                </div>
            </div>

            <div id="step3b" class="hidden">
                <div class="arrow"></div>
                <div class="question-box">
                    <strong>【STEP 3B】あなたの状況を教えてください</strong>
                    <div class="explanation">
                        申告基準が状況により異なります
                    </div>
                </div>
                <div class="info-box">
                    💡 <strong>所得区分について：</strong>継続的・本格的な活動で帳簿をつけている場合は、節税メリットの大きい「事業所得」として申告できる可能性があります。それ以外は通常「雑所得」となります。
                </div>
                <div class="answer-section">
                    <button class="answer-button" onclick="nextStep(3, 'employee')">会社員・パート</button>
                    <button class="answer-button" onclick="nextStep(3, 'student')">学生</button>
                    <button class="answer-button" onclick="nextStep(3, 'housewife')">専業主婦・無職</button>
                    <button class="answer-button" onclick="nextStep(3, 'business-owner')">個人事業主・フリーランス</button>
                </div>
                <div class="warning-box">
                    ※年金受給者の方は、公的年金等の収入額によって基準が異なりますので、本診断の対象外です。税務署や税理士にご相談ください。
                </div>
            </div>

            <div id="step3c" class="hidden">
                <div class="arrow"></div>
                <div class="question-box">
                    <strong>【STEP 3C】年間の利益はいくらですか？</strong>
                    <div class="explanation">
                        小規模でも利益があれば申告が必要な場合があります。利益は「雑所得」と見なされます。
                    </div>
                </div>
                <div class="answer-section">
                    <button class="answer-button" onclick="nextStep(3, 'small-scale')">20万円以下</button>
                    <button class="answer-button yes" onclick="nextStep(3, 'medium-scale')">20万円超</button>
                </div>
            </div>

            <div id="step3d" class="hidden">
                <div class="arrow"></div>
                <div class="question-box">
                    <strong>【STEP 3D】売却価格は購入価格を上回りましたか？</strong>
                    <div class="explanation">
                        譲渡所得は購入価格との差額で判定されます
                    </div>
                </div>
                <div class="calculation-help">
                    <h4>💎 譲渡所得の計算</h4>
                    <strong>譲渡所得 = 売却価格 - 購入価格 - 譲渡費用</strong><br>
                    ※この所得には年間50万円の特別控除があります。
                </div>
                <div class="answer-section">
                    <button class="answer-button yes" onclick="showResult('collectible-gain')">利益が出た</button>
                    <button class="answer-button" onclick="showResult('collectible-loss')">損失・同額</button>
                </div>
            </div>

            <div id="step4a" class="hidden">
                <div class="arrow"></div>
                <div class="question-box">
                    <strong>【STEP 4A】年間の利益（所得）はいくらですか？</strong>
                    <div class="explanation">
                        売上から経費を引いた純利益で判定します。他の副業収入があれば、それも合算してください。
                    </div>
                </div>
                <div class="calculation-help">
                    <h4>📊 利益の正確な計算方法</h4>
                    <strong>年間利益 = 売上 - 必要経費</strong><br>
                    <u>経費例</u>：販売手数料、送料、仕入代金、梱包材費、振込手数料、通信費（按分）、交通費など
                </div>
                <div class="answer-section">
                    <button class="answer-button" onclick="showResult('employee-under20')">20万円以下</button>
                    <button class="answer-button yes" onclick="showResult('employee-over20')">20万円超</button>
                </div>
            </div>

            <div id="step4b" class="hidden">
                <div class="arrow"></div>
                <div class="question-box">
                    <strong>【STEP 4B】アルバイトをしていますか？</strong>
                    <div class="explanation">
                        アルバイト収入の有無で所得の基準が変わります
                    </div>
                </div>
                <div class="answer-section">
                    <button class="answer-button yes" onclick="nextStep(4, 'student-work')">はい（バイトしている）</button>
                    <button class="answer-button" onclick="nextStep(4, 'student-nowork')">いいえ（バイトしていない）</button>
                </div>
            </div>

            <div id="step4c" class="hidden">
                <div class="arrow"></div>
                <div class="question-box">
                    <strong>【STEP 4C】年間の利益（所得）はいくらですか？</strong>
                    <div class="explanation">
                        2025年（令和7年）分からの税制改正で基礎控除額が変わります。
                    </div>
                </div>
                <div class="calculation-help">
                    <h4>⚠️ 重要：2025年分からの税制改正</h4>
                    所得税の**基礎控除額が48万円から58万円に引き上げ**られます。そのため、確定申告が必要になる基準も変わります。<br>
                    ※この所得が48万円（2025年分から58万円）を超えると、配偶者控除に影響が出る場合があります。
                </div>
                <div class="answer-section">
                    <button class="answer-button" onclick="showResult('housewife-safe')">58万円以下</button>
                    <button class="answer-button yes" onclick="showResult('housewife-over')">58万円超</button>
                </div>
            </div>

            <div id="step4d" class="hidden">
                <div class="arrow"></div>
                <div class="question-box">
                    <strong>【STEP 4D】事業所得 vs 雑所得の判定</strong>
                    <div class="explanation">
                        この判定が税額を大きく左右します（2022年改正で厳格化）
                    </div>
                </div>
                <div class="income-classification">
                    <div class="classification-title">📊 所得区分判定チェック</div>
                    <div class="classification-criteria">
                        <strong>事業所得と認められるには、帳簿の作成・保存が必須条件</strong>です。その上で、活動の営利性・継続性・規模などを総合的に判断します。
                    </div>
                    <div class="vs-comparison">
                        <div class="business-income">
                            <strong>🏢 事業所得のメリット</strong><br>
                            • 青色申告控除：最大65万円<br>
                            • 損益通算：赤字を他所得と相殺<br>
                            • 経費範囲：家事按分など幅広く認定<br>
                            • 各種共済：小規模企業共済等加入可
                        </div>
                        <div class="misc-income">
                            <strong>📝 雑所得の特徴</strong><br>
                            • 特別控除：なし<br>
                            • 損益通算：不可<br>
                            • 経費範囲：限定的<br>
                            • 節税手段：ほぼなし
                        </div>
                    </div>
                </div>
                <div class="answer-section">
                    <button class="answer-button yes" onclick="showResult('business-income-complete')">帳簿があり事業と断言できる</button>
                    <button class="answer-button" onclick="showResult('misc-income-over20')">帳簿がなく雑所得になる</button>
                </div>
            </div>
            
            <div id="step5a" class="hidden">
                <div class="arrow"></div>
                <div class="question-box">
                    <strong>【STEP 5A】販売による年間利益はいくらですか？</strong>
                    <div class="explanation">
                        勤労学生控除の適用範囲を確認します
                    </div>
                </div>
                <div class="calculation-help">
                    <h4>🎓 勤労学生控除の条件</h4>
                    「勤労によらない所得（メルカリなど）」が**10万円以下**であることが条件の一つです。<br>
                    ※2025年分から、控除全体の合計所得要件は85万円以下（給与収入のみなら**140万円以下**）に緩和されます。
                </div>
                <div class="answer-section">
                    <button class="answer-button" onclick="showResult('student-work-safe')">10万円以下</button>
                    <button class="answer-button yes" onclick="showResult('student-work-over')">10万円超</button>
                </div>
            </div>

            <div id="step5b" class="hidden">
                <div class="arrow"></div>
                <div class="question-box">
                    <strong>【STEP 5B】年間の利益（所得）はいくらですか？</strong>
                    <div class="explanation">
                        バイトをしていない学生の場合、基礎控除額が基準になります。
                    </div>
                </div>
                 <div class="calculation-help">
                    <h4>⚠️ 重要：2025年分からの税制改正</h4>
                    所得税の**基礎控除額が48万円から58万円に引き上げ**られます。<br>
                    ※所得が58万円を超えると、親の扶養からも外れるため、家族の税金に大きな影響が出ます。必ず事前に相談してください。
                </div>
                <div class="answer-section">
                    <button class="answer-button" onclick="showResult('student-nowork-safe')">58万円以下</button>
                    <button class="answer-button yes" onclick="showResult('student-nowork-over')">58万円超</button>
                </div>
            </div>

            <div id="results" class="hidden">
                <div class="arrow"></div>
                <div id="result-content"></div>
                <button class="reset-button" onclick="resetFlow()">🔄 最初からやり直す</button>
            </div>
        </div>
    </div>

    <script>
        function nextStep(currentStep, choice) {
            hideAllSteps();
           
            if (currentStep === 1) {
                if (choice === 'lifestyle') {
                    document.getElementById('step2a').classList.remove('hidden');
                } else if (choice === 'business') {
                    document.getElementById('step2b').classList.remove('hidden');
                } else if (choice === 'collectible') {
                    document.getElementById('step2c').classList.remove('hidden');
                }
            } else if (currentStep === 2) {
                if (choice === 'lifestyle-cheap') {
                    document.getElementById('step3a').classList.remove('hidden');
                } else if (choice === 'business-regular') {
                    document.getElementById('step3b').classList.remove('hidden');
                } else if (choice === 'business-occasional') {
                    document.getElementById('step3c').classList.remove('hidden');
                } else if (choice === 'collectible-luxury') {
                    document.getElementById('step3d').classList.remove('hidden');
                } else if (choice === 'collectible-normal') {
                    showResult('collectible-normal');
                }
            } else if (currentStep === 3) {
                if (choice === 'lifestyle-business') {
                    document.getElementById('step3b').classList.remove('hidden');
                } else if (choice === 'employee') {
                    document.getElementById('step4a').classList.remove('hidden');
                } else if (choice === 'student') {
                    document.getElementById('step4b').classList.remove('hidden');
                } else if (choice === 'housewife') {
                    document.getElementById('step4c').classList.remove('hidden');
                } else if (choice === 'business-owner') {
                    document.getElementById('step4d').classList.remove('hidden');
                } else if (choice === 'small-scale') {
                    showResult('small-scale');
                } else if (choice === 'medium-scale') {
                    showResult('medium-scale');
                }
            } else if (currentStep === 4) {
                if (choice === 'student-work') {
                    document.getElementById('step5a').classList.remove('hidden');
                } else if (choice === 'student-nowork') {
                    document.getElementById('step5b').classList.remove('hidden');
                }
            }
        }

        function showResult(resultType) {
            hideAllSteps();
           
            const results = document.getElementById('results');
            const content = document.getElementById('result-content');
           
            let resultHTML = '';
           
            switch (resultType) {
                case 'lifestyle-safe':
                    resultHTML = `
                        <div class="result-box not-required">
                            <strong>🎉 確定申告は不要です！</strong><br>
                            生活用動産の売却は非課税です
                        </div>
                        <div class="explanation">
                            <strong>理由：</strong>日常生活で使用していた物品（生活用動産）の売却は所得税法により非課税と規定されています。確定申告も住民税申告も不要です。
                            <br><br><strong>対象例：</strong>古着、家具、家電、書籍、CD、通勤用自動車など
                        </div>
                    `;
                    break;
                
                case 'lifestyle-expensive':
                    resultHTML = `
                        <div class="result-box required">
                            <strong>⚠️ 確定申告が必要です</strong><br>
                            高額品は譲渡所得として課税対象
                        </div>
                        <div class="explanation">
                            <strong>理由：</strong>1個または1組30万円を超える物品の売却は、生活用動産であっても譲渡所得として課税対象になります。
                            <br><br><strong>計算方法：</strong>譲渡所得 = 売却価格 - 購入価格 - 譲渡費用（50万円の特別控除あり）
                        </div>
                    `;
                    break;
               
                case 'collectible-gain':
                    resultHTML = `
                        <div class="result-box required">
                            <strong>📋 確定申告が必要です</strong><br>
                            譲渡所得として申告してください
                        </div>
                        <div class="explanation">
                            <strong>理由：</strong>「生活に通常必要でない動産」の売却で利益が出た場合は譲渡所得として課税されます。
                            <br><br><strong>特別控除：</strong>年間50万円まで控除あり。複数の譲渡がある場合は合算して判定します。
                        </div>
                    `;
                    break;
               
                case 'collectible-loss':
                    resultHTML = `
                        <div class="result-box not-required">
                            <strong>🎉 確定申告は不要です</strong><br>
                            譲渡損失は課税されません
                        </div>
                        <div class="explanation">
                            <strong>理由：</strong>売却価格が購入価格以下の場合、譲渡所得は発生しないため申告不要です。譲渡損失は他の所得と損益通算できません。
                        </div>
                    `;
                    break;
                
                case 'collectible-normal':
                    resultHTML = `
                        <div class="result-box partial">
                            <strong>⚖️ 判定が分かれます</strong><br>
                            営利目的・継続性があれば課税対象
                        </div>
                        <div class="explanation">
                            <strong>判定：</strong>収集品が「生活に通常必要でない動産」に該当しない場合、その売却が営利目的で継続的に行われていれば「雑所得」として課税対象になります。単なる不用品処分であれば非課税です。最初のSTEP1に戻り「営利目的」か「生活用品の処分」か、ご自身の状況に近い方を選択してください。
                        </div>
                    `;
                    break;

                case 'employee-under20':
                    resultHTML = `
                        <div class="result-box partial">
                            <strong>📋 所得税：申告不要</strong><br>
                            <strong class="highlight">⚠️ 住民税：申告必要</strong>
                        </div>
                        <div class="explanation">
                            <strong>重要：</strong>給与所得者の「20万円ルール」は所得税のみに適用されます。住民税には適用されないため、金額に関わらず住民税の申告が必要です。
                            <br><br><strong>所得区分：</strong>雑所得として申告（帳簿保存がない場合）
                        </div>
                        <div class="action-plan">
                            <h4>🚀 必要なアクション</h4>
                            <div class="action-step">
                                <strong>住民税の申告：</strong>お住まいの市区町村役場の税務課に、雑所得があった旨を申告します。（期限：原則3月15日）
                            </div>
                        </div>
                    `;
                    break;
               
                case 'employee-over20':
                case 'medium-scale':
                    resultHTML = `
                        <div class="result-box required">
                            <strong>📋 確定申告が必要です</strong><br>
                            20万円を超える所得は申告義務があります
                        </div>
                        <div class="explanation">
                            <strong>理由：</strong>所得が20万円を超える場合は確定申告が必要です。
                            <br><br><strong>所得区分：</strong>帳簿を付けていなければ「雑所得」、帳簿があり事業として活動していれば「事業所得」として申告します。
                        </div>
                        <div class="action-plan">
                            <h4>🚀 必要なアクション</h4>
                             <div class="deadline-warning">⏰ 確定申告期限：翌年3月15日まで</div>
                            <div class="action-step">
                                <strong>申告準備：</strong>年間の売上と経費をまとめ、所得額を計算します。給与所得者は源泉徴収票も必要です。
                            </div>
                             <div class="action-step">
                                <strong>申告書の作成・提出：</strong>国税庁の「確定申告書等作成コーナー」を利用して作成し、e-Tax、郵送、または税務署窓口で提出します。
                            </div>
                        </div>
                    `;
                    break;
               
                case 'housewife-safe':
                case 'student-nowork-safe':
                    resultHTML = `
                        <div class="result-box partial">
                            <strong>📋 所得税：申告不要</strong><br>
                            <strong class="highlight">⚠️ 住民税：申告が必要な場合あり</strong>
                        </div>
                        <div class="explanation">
                            <strong>理由：</strong>2025年分から基礎控除が58万円に引き上げられるため、所得が58万円以下なら所得税の申告は不要です。
                            <br><br><strong>注意点：</strong>住民税の基礎控除は一律43万円（据え置き）です。所得が43万円を超えると住民税がかかり始める可能性があります。また、所得が48万円（2025年分から58万円）を超えると配偶者（親）の扶養から外れ、家族の税金に影響が出るため必ず相談してください。
                        </div>
                         <div class="action-plan">
                            <h4>🚀 必要なアクション</h4>
                            <div class="action-step">
                                <strong>住民税の申告：</strong>所得がある場合は、お住まいの市区町村役場に住民税の申告が必要か確認してください。
                            </div>
                        </div>
                    `;
                    break;
               
                case 'housewife-over':
                case 'student-nowork-over':
                    resultHTML = `
                        <div class="result-box required">
                            <strong>📋 確定申告が必要です</strong><br>
                            基礎控除額（58万円）を超えました
                        </div>
                        <div class="explanation">
                            <strong>理由：</strong>所得が58万円を超える場合は確定申告が必要です。
                            <br><br><strong>最重要：</strong>この所得額では配偶者（親）の税法上の扶養から外れます。家族の税負担が大きく増える可能性があるため、必ず事前に家族と相談してください。
                        </div>
                         <div class="action-plan">
                            <h4>🚀 必要なアクション</h4>
                             <div class="deadline-warning">⏰ 確定申告期限：翌年3月15日まで</div>
                            <div class="action-step">
                                <strong>家族と相談：</strong>扶養から外れることによる影響を共有し、理解を得ることが最も重要です。
                            </div>
                             <div class="action-step">
                                <strong>確定申告：</strong>所得を計算し、期限内に申告・納税を行ってください。
                            </div>
                        </div>
                    `;
                    break;

                case 'student-work-safe':
                    resultHTML = `
                        <div class="result-box partial">
                            <strong>📋 所得税：申告不要の可能性大</strong><br>
                            <strong class="highlight">⚠️ 住民税：申告必要</strong>
                        </div>
                        <div class="explanation">
                            <strong>勤労学生控除：</strong>販売による利益が10万円以下で、アルバイト収入と合わせても合計所得が85万円以下（給与収入のみなら**140万円以下**）であれば、勤労学生控除の範囲内となり所得税はかかりません。
                            <br><br><strong>注意：</strong>住民税の申告は別途必要です。
                        </div>
                    `;
                    break;

                case 'student-work-over':
                    resultHTML = `
                        <div class="result-box required">
                            <strong>📋 確定申告が必要です</strong><br>
                            勤労学生控除の条件を超えました
                        </div>
                        <div class="explanation">
                            <strong>理由：</strong>販売による利益が10万円を超えたため、勤労学生控除の「勤労によらない所得10万円以下」という条件から外れます。アルバイト収入と合算して確定申告が必要です。
                             <br><br><strong>重要：</strong>合計所得が48万円（2025年分から58万円）を超えると親の扶養からも外れるため、家族と必ず相談してください。
                        </div>
                    `;
                    break;
                
                case 'business-income-complete':
                    resultHTML = `
                        <div class="result-box required">
                            <strong>🏢 事業所得として確定申告</strong><br>
                            最大限の節税メリットを活用しましょう
                        </div>
                        <div class="explanation">
                            適切な帳簿管理により「事業所得」として申告できます。青色申告特別控除や損益通算など多くのメリットを受けられます。
                        </div>
                        <div class="action-plan">
                            <h4>🚀 事業所得フル活用のアクション</h4>
                            <div class="deadline-warning">⏰ 確定申告期限：翌年3月15日まで</div>
                            <div class="action-step">
                                <strong>青色申告の活用：</strong>e-Taxでの電子申告と複式簿記により、最大65万円の特別控除を目指しましょう。
                            </div>
                            <div class="action-step">
                                <strong>必要経費の計上：</strong>家賃や通信費の家事按分、備品の減価償却など、事業に関連する費用を漏れなく経費として計上します。
                            </div>
                        </div>
                    `;
                    break;

                case 'misc-income-over20':
                     resultHTML = `
                        <div class="result-box required">
                            <strong>📝 雑所得として確定申告</strong><br>
                            節税メリットが限定的です
                        </div>
                        <div class="explanation">
                           <strong>理由：</strong>帳簿の保存がない場合、所得は「雑所得」として扱われます。この場合、青色申告控除や赤字の損益通算はできません。
                        </div>
                        <div class="action-plan">
                            <h4>🚀 今後の改善アクション</h4>
                            <div class="action-step">
                                <strong>今年の申告：</strong>まずは雑所得として期限内に確定申告を済ませましょう。
                            </div>
                            <div class="action-step">
                                <strong>来年に向けて：</strong>継続的に利益が見込めるなら、会計ソフトを導入して帳簿作成を始め、「事業所得」での申告を目指すことを強く推奨します。
                            </div>
                        </div>
                    `;
                    break;

                case 'small-scale':
                    resultHTML = `
                        <div class="result-box partial">
                            <strong>📋 所得税：申告不要</strong><br>
                            <strong class="highlight">⚠️ 住民税：申告必要</strong>
                        </div>
                        <div class="explanation">
                            <strong>理由：</strong>時々・小規模な販売による利益（雑所得）が20万円以下の場合、給与所得者の副業と同じく、所得税の確定申告は不要です。ただし、住民税の申告は必要です。
                        </div>
                    `;
                    break;
            }
           
            content.innerHTML = resultHTML;
            results.classList.remove('hidden');
        }

        function hideAllSteps() {
            const steps = ['step2a', 'step2b', 'step2c', 'step3a', 'step3b', 'step3c', 'step3d', 
                         'step4a', 'step4b', 'step4c', 'step4d', 'step5a', 'step5b', 'results'];
            steps.forEach(step => {
                const element = document.getElementById(step);
                if (element) {
                    element.classList.add('hidden');
                }
            });
        }

        function resetFlow() {
            hideAllSteps();
            window.scrollTo({top: 0, behavior: 'smooth'});
        }
    </script>
</body>
</html>
